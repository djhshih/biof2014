---
title: "Model fitting and parameter estimation"
author: "David J. H. Shih"
format:
  beamer:
    include-in-header:
      - text: |
          \usepackage{amsfonts}
          \usepackage{amsmath}
          \usepackage{amssymb}
          \usepackage{amsthm}
          \usepackage{bm}
          \usepackage{bbm}
          \usepackage[english]{babel}
          \usepackage{fixmath}
          \usepackage{mathrsfs}
          \usepackage{mathtools}
          \DeclareMathOperator*{\argmax}{argmax}
classoption: t  
---

## Intended learning outcomes {.c}

- Fit models to data by estimating model parameters


## Model fitting

Use data $\symbfit{x}$ to estimate parameters $\symbfit{\theta}$ of the model.

### Maximum likelihoood estimation (MLE)
$$
\hat{\symbfit{\theta}} 
 = \argmax_{\symbfit{\theta}}
  p\left( \symbfit{x} \mid \symbfit{\theta} \right) .
$$

### Maximum *a posteriori* (MAP)
$$
\hat{\symbfit{\theta}} 
 = \argmax_{\symbfit{\theta}}
  p\left( \symbfit{\theta} \mid \symbfit{x} \right)
 = \argmax_{\symbfit{\theta}}
  p\left( \symbfit{x} \mid \symbfit{\theta} \right) \,
  p\left( \symbfit{\theta} \right) .
$$

### Full Bayesian
$$
p\left( \symbfit{\theta} \mid \symbfit{x} \right)
 = \frac{
  p\left( \symbfit{x} \mid \symbfit{\theta} \right) \,
  p\left( \symbfit{\theta} \right)
 }{
  p\left( \symbfit{x} \right)
 } .
$$

## Generating new samples

Use $\hat{\symbfit{\theta}}$ or 
$p\left( \symbfit{\theta} \mid \symbfit{x} \right)$ to generate 
a new data point $\tilde{x}$.

### With point estimate from MLE or MAP
$$
\tilde{x} \sim 
 p\left( \tilde{x} \mid \hat{\symbfit{\theta}} \right) .
$$

### With posterior predictive distribution
$$
\begin{aligned}
p\left( \tilde{x} \mid \symbfit{x} \right)
 &= \int_{\symbfit{\Theta}}
  p\left( \tilde{x} \mid \symbfit{\theta} \right) \,
  p\left( \symbfit{\theta} \mid \symbfit{x} \right) \,
 d \symbfit{\theta}  \\
\tilde{x}
 &\sim p\left( \tilde{x} \mid \symbfit{x} \right) .
\end{aligned}
$$

### With posterior distribution
$$
\symbfit{\theta}
 \sim p(\symbfit{\theta} \mid \symbfit{x}), \quad
\tilde{x}
 \sim p\left( \tilde{x} \mid \symbfit{\theta} \right) .
$$


## Summary

"All Models Are Wrong, Some are Useful."
- George Box

\bigskip

Blais 2014, chapter 6.


### Intended learning outcomes {.c}

- Fit models to data by estimating model parameters
